---
title: "ASHRAE Energy Prediction - Exploratory Data Analysis"
output: html_notebook
---


## Setup    
  Load the relevant libraries.
```{r message=TRUE, warning=TRUE}

# rm(list = ls())
# .rs.restartR()


# data munging
library("tidyverse")
library("data.table")

# munge dates
library("lubridate")

# get tweets
# library("rtweet")

# NLP
# library("tidytext")
# library("syuzhet")
# library("googleLanguageR")

# graph analyses
# library("tidygraph")
# library("ggraph")

# # feature engineering and data prep
# library("recipes")
# library("caret")
# library("DMwR")
# 
# # to explore missing data
# library("visdat")
# library("naniar")
# 
# # modeling
# library("h2o")

```
  
    
  Session Info.
```{r}

sessionInfo()

```


  Setup the root directory.
```{r "setup", include = FALSE}

require("knitr")

# Use when running from AWS
# opts_knit$set(root.dir = "/home/rstudio/Dropbox/_AWS/twitter_dc_metro2/")

# Use when running from laptop
opts_knit$set(root.dir = "/Users/mdturse/Desktop/Analytics/ashrae_energy_prediction/")

```
  
    
  Setting `wd` as the working directory.
```{r}

wd <- getwd()

wd

```


## Get the data  

```{r}

file_names <-
  list.files(path = paste0(wd,
                           "/Data/Raw"
                           )
             )

files_list <-
  file_names %>% 
  map(~read_csv(file = paste0(wd,
                              "/Data/Raw/",
                              .x
                              )
                )
      )

names(files_list) <- file_names

glimpse(files_list)

```



```{r}

cnts_bldg_mtr <-
  files_list$train.csv %>% 
  count(building_id,
        meter,
        # timestamp
        ) %>% 
  arrange(building_id,
          meter
          )

cnts_bldg_mtr

cnts_bldg_mtr_reading_abv_zero <-
  files_list$train.csv %>% 
  filter(meter_reading > 0) %>% 
  count(building_id,
        meter,
        # timestamp
        ) %>% 
  arrange(building_id,
          meter
          )

cnts_bldg_mtr_reading_abv_zero


cnts_mtr <-
  cnts_bldg_mtr %>% 
  count(meter,
        wt = n
        )

cnts_mtr


cnts_mtr_reading_abv_zero <-
  cnts_bldg_mtr_reading_abv_zero %>% 
  count(meter,
        wt = n
        )

cnts_mtr_reading_abv_zero

```



```{r}

bldg_7 <-
  files_list$train.csv %>% 
  filter(building_id == 7)

bldg_7_mtr_0 <-
  files_list$train.csv %>% 
  filter(building_id == 7 &
           meter == 0
         )

glimpse(bldg_1_mtr_0)
summary(bldg_1_mtr_0)
View(bldg_1_mtr_0)


bldg_7 %>% 
  ggplot(aes(x = timestamp,
             y = meter_reading
             )
         ) +
  geom_line() +
  facet_wrap(vars(meter),
             scales = "free"
             ) +
  theme_minimal()

```



